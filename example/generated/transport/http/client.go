// This file was automatically generated by "microgen 0.9.0-beta" utility.
// DO NOT EDIT.
package transporthttp

import (
	service "github.com/devimteam/microgen/example/generated"
	http1 "github.com/devimteam/microgen/example/generated/transport/converter/http"
	log "github.com/go-kit/kit/log"
	opentracing "github.com/go-kit/kit/tracing/opentracing"
	http "github.com/go-kit/kit/transport/http"
	opentracinggo "github.com/opentracing/opentracing-go"
	"net/url"
	"strings"
)

func NewHTTPClient(addr string, logger log.Logger, tracer opentracinggo.Tracer, opts ...http.ClientOption) (service.StringService, error) {
	if !strings.HasPrefix(addr, "http") {
		addr = "http://" + addr
	}
	u, err := url.Parse(addr)
	if err != nil {
		return nil, err
	}
	opts = append(opts, http.ClientBefore(
		opentracing.ContextToHTTP(tracer, logger),
	))
	return &service.Endpoints{
		CountEndpoint: opentracing.TraceClient(
			tracer,
			"Count",
		)(
			http.NewClient(
				"GET",
				u,
				http1.EncodeCountRequest,
				http1.DecodeCountResponse,
				opts...,
			).Endpoint(),
		),
		TestCaseEndpoint: opentracing.TraceClient(
			tracer,
			"TestCase",
		)(
			http.NewClient(
				"POST",
				u,
				http1.EncodeTestCaseRequest,
				http1.DecodeTestCaseResponse,
				opts...,
			).Endpoint(),
		),
		UppercaseEndpoint: opentracing.TraceClient(
			tracer,
			"Uppercase",
		)(
			http.NewClient(
				"POST",
				u,
				http1.EncodeUppercaseRequest,
				http1.DecodeUppercaseResponse,
				opts...,
			).Endpoint(),
		),
	}, nil
}
